<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<!-- <html xmlns="http://www.w3.org/1999/xhtml"> -->

<html lang="en" xmlns:th="http://www.thymeleaf.org" th:replace="~{navbar::layout(~{::section})}">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet"
        id="bootstrap-css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <!------ Include the above in your HEAD tag ---------->
    <title></title>
    <style>
        .table-sortable tbody tr {
            cursor: move;
        }
    </style>
</head>

<body>
    <section th:fragment="form_po">

        <!-- <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.4/jquery-ui.min.js"></script> -->
        <link rel="stylesheet" th:href="@{/css/ProductForm.css}" />
        <div class="form-floating col-md-6 mx-auto mb-3 text-center col-4 aligh-center">
            <h1><u>Purchase Order</u></h1>
        </div>
        <form action="/savePO" method="post" enctype="multipart/form-data">
            <div class="panel mlr-15" id="pnl_po">
                <div>
                    <div class="panel-header">
                        <h3>Purchase Order Details</h3>
                    </div>
                    <div class="mb-2 col-6 text-center mt-2 d-flex mlr">
                        <div class="form-floating mb-3 col-7               ">
                            <input type="text" class="form-control" name="ponumber" id="html_challanno" data-field="challanno" />
                            <label for="floatingInput mr-5" class="ml-15 md_lbl">PO Number</label>
                            <span class="_error2"></span>
                        </div>
                        <div class="form-floating mb-3 col-7 mandatory">
                            <label for="" class="md_lblsel"></label>
                            <select class="form-select form-select-lg mb-3" name="supplier_fid" aria-label=".form-select-lg example"
                                id="html_supplier" data-field="supplier_fid">
                                <option selected value="">Supplier</option>
                                <option th:each="s:${suppliers}" th:value="${s.supplier_pid}"
                                    th:text="${s.code + ' - ' + s.name}"></option>


                            </select>
                            <span class="_error2" style="position: absolute !important;"></span>
                        </div>
                        <div class="form-floating mb-3 col-7 mandatory">
                            <input type="date" class="form-control" name="poDate" id="" data-field="challandate" />
                            <label for="floatingInput mr-5" class="ml-15 md_lbl">PO Date</label>
                            <span class="_error2"></span>
                        </div>

                    </div>
                    <div class="mb-2 col-6 text-center mt-2 d-flex mlr ">
                        <div class="form-floating mb-3 col-7 mandatory">
                            <input type="date" class="form-control" name="podueDate" id="" data-field="challandate" />
                            <label for="floatingInput mr-5" class="ml-15 md_lbl">PO Due Date</label>
                            <span class="_error2"></span>
                        </div>
                        <div class="form-floating mb-3 col-7 ">
                            <input type="date" class="form-control" id="" name="poreceivedDate" data-field="challandate" />
                            <label for="floatingInput mr-5" class="ml-15 md_lbl">PO Received Date</label>
                            <span class="_error2"></span>
                        </div>
                        <div class="form-floating mb-2 col-7 mandatory">
                            <input type="number" class="form-control" id="html_Quantity" name="qty" data-field="quantity" />
                            <label for="floatingInput mr-5" class="ml-15 md_lbl">PO Estimated Quantity</label>
                            <span class="_error2">

                            </span>
                        </div>
                    </div>
                    <div class="mb-2 col-6 text-center mt-2 d-flex mlr ">
                        <div class="form-floating mb-2 col-7 mandatory">
                            <input type="number" class="form-control" id="" name="amt" data-field="amount" />
                            <label for="floatingInput mr-5" class="ml-15 md_lbl">PO Estimated Amount</label>
                            <span class="_error2"></span>
                        </div>
                        <div class="form-floating mb-2 col-7 mandatory">
                            <input type="file" class="form-control" name="file" id="" data-field="amount" />
                            <label for="floatingInput mr-5" class="ml-15 md_lbl">PO Detail File</label>
                            <span class="_error2"></span>
                        </div>

                    </div>
                    <div class="mb-2 col-12 text-center mt-2 d-flex mlr ">
                        <div class="form-floating mb-2 col-12 mandatory">
                            <textarea  id="" cols="30" rows="10" name="note" class="form-control"
                                data-field="amount"></textarea>

                            <label for="floatingInput mr-5" class="ml-15 md_lbl">PO Note</label>
                            <span class="_error2"></span>
                        </div>
                    </div>

                </div>
                <div class="d-flex mb-2 btn-div mt-5">
                    <div class="noselect btn_del ml" id="btn_cancle">
                        <span class="text">Cancel</span><span class="icon"><svg xmlns="http://www.w3.org/2000/svg"
                                width="24" height="24" viewBox="0 0 24 24">
                                <path
                                    d="M24 20.188l-8.315-8.209 8.2-8.282-3.697-3.697-8.212 8.318-8.31-8.203-3.666 3.666 8.321 8.24-8.206 8.313 3.666 3.666 8.237-8.318 8.285 8.203z">
                                </path>
                            </svg></span>
                    </div>
                    <div class="noselect btn_add ml" id="tbl_addPouy">
                        <span class="text">Save</span><span class="icon">
                            <!-- <svg xmlns="http://www.w3.org/2000/svg" height="1em"
                            viewBox="0 0 512 512">
                            Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. 
                            <path                                d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM232 344V280H168c-13.3 0-24-10.7-24-24s10.7-24 24-24h64V168c0-13.3 10.7-24 24-24s24 10.7 24 24v64h64c13.3 0 24 10.7 24 24s-10.7 24-24 24H280v64c0 13.3-10.7 24-24 24s-24-10.7-24-24z" />
                        </svg> -->
                            <svg xmlns="http://www.w3.org/2000/svg" height="16" width="14"
                                viewBox="0 0 448 512"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.-->
                                <path
                                    d="M64 32C28.7 32 0 60.7 0 96V416c0 35.3 28.7 64 64 64H384c35.3 0 64-28.7 64-64V173.3c0-17-6.7-33.3-18.7-45.3L352 50.7C340 38.7 323.7 32 306.7 32H64zm0 96c0-17.7 14.3-32 32-32H288c17.7 0 32 14.3 32 32v64c0 17.7-14.3 32-32 32H96c-17.7 0-32-14.3-32-32V128zM224 288a64 64 0 1 1 0 128 64 64 0 1 1 0-128z" />
                            </svg>






                        </span>
                    </div>

                </div>
            </div>
        </form>
        <script>
            $(document).ready(function () {


                $("#master .fa-caret-down").toggleClass("tarnsform");
                $(".clild-menu_master").slideToggle();


                $("#tbl_addPouy").click(() => {

                    if (validPanel("pnl_po")) {
                        $("form").submit();
                    }

                })

                $('form').submit(function (event) {
            event.preventDefault(); // Prevent the default form submission

            // Create FormData object to send file and other data
            var formData = new FormData($(this)[0]);
            $(".customloader").show();
            // Send AJAX request
            $.ajax({
                url: '/savePO',
                type: 'POST',
                data: formData,
                contentType: false,
                processData: false,
                success: function (data) {

                    debugger;
                    //console.log('Success:', data);
                    showToasty("<i class='fa-solid fa-square-check fa-shake fa-xl text-white'>&nbsp;&nbsp</i>", "bg-success", data, "Success")
                    $('form')[0].reset()
                    $(".customloader").hide();
                },
                error: function (xhr, status, error) {
                    debugger;
                    showToasty("<i class='fa-solid fa-triangle-exclamation fa-shake fa-xl text-white'>&nbsp;&nbsp;</i>", "bg-danger", "Something Went Wrong! Please Try Again...", "Error")
           
                    $(".customloader").hide();
                    console.error('Error:', error);
                    // Handle error response
                }
            });
        });




            });
        </script>
    </section>
</body>

</html>